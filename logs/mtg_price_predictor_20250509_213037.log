2025-05-09 21:30:37,719 - INFO - Loading card data from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:30:37,744 - INFO - Loaded 22037 cards from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:30:37,745 - INFO - Loading card attributes from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_attributes.csv
2025-05-09 21:30:37,899 - INFO - Loaded 284714 card attributes from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_attributes.csv
2025-05-09 21:30:37,928 - INFO - Merged data contains 22037 cards with attributes
2025-05-09 21:30:38,223 - INFO - Saved 22037 cards to C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_data_20250509_213037.json
2025-05-09 21:30:38,228 - INFO - Card data processing completed successfully
2025-05-09 21:30:38,263 - INFO - Loaded 22037 card_sku_id values from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:30:38,386 - INFO - Connected to TimescaleDB database: tsdb
2025-05-09 21:31:03,024 - INFO - Filtered to 16021 card_sku_id values with >= 12 sales over 60 days
2025-05-09 21:31:03,026 - INFO - Querying table: market_prices
2025-05-09 21:31:09,955 - INFO - Queried market_prices with 897172 records in 6.93 seconds
2025-05-09 21:31:09,956 - INFO - Querying table: sales_history
2025-05-09 21:31:28,576 - INFO - Queried sales_history with 1644689 records in 18.62 seconds
2025-05-09 21:31:28,576 - INFO - Querying table: listings
2025-05-09 21:32:16,986 - INFO - Queried listings with 2523088 records in 48.41 seconds
2025-05-09 21:32:17,055 - INFO - Market data fetch from TimescaleDB completed successfully
2025-05-09 21:32:17,216 - INFO - Starting data cleaning with card and market DataFrames
2025-05-09 21:32:17,362 - INFO - Processed market_prices with 897172 records
2025-05-09 21:32:17,441 - INFO - Original sales_history price stats: mean=6.23, median=6.08, std=1.25
2025-05-09 21:32:24,944 - INFO - Method zscore: Removed 1252 outliers from price in sales_history
2025-05-09 21:32:38,773 - INFO - Method iqr: Removed 88542 outliers from price in sales_history
2025-05-09 21:32:52,854 - INFO - Method percentile: Removed 36704 outliers from price in sales_history
2025-05-09 21:32:52,855 - ERROR - Unexpected error in clean_data: 'card_sku_id'
2025-05-09 21:32:52,864 - INFO - Error logged to C:\Users\mprov\PycharmProjects\mtg_price_predictor\logs\error_log.json: Cleaning data
