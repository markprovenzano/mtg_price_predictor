2025-05-09 21:09:27,848 - INFO - Loading card data from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:09:27,872 - INFO - Loaded 22037 cards from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:09:27,872 - INFO - Loading card attributes from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_attributes.csv
2025-05-09 21:09:28,049 - INFO - Loaded 284714 card attributes from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_attributes.csv
2025-05-09 21:09:28,081 - INFO - Merged data contains 22037 cards with attributes
2025-05-09 21:09:28,384 - INFO - Saved 22037 cards to C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_data_20250509_210928.json
2025-05-09 21:09:28,389 - INFO - Card data processing completed successfully
2025-05-09 21:09:28,418 - INFO - Loaded 22037 card_sku_id values from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-09 21:09:28,644 - INFO - Connected to TimescaleDB database: tsdb
2025-05-09 21:09:52,971 - INFO - Filtered to 16021 card_sku_id values with >= 12 sales over 60 days
2025-05-09 21:09:52,973 - INFO - Querying table: market_prices
2025-05-09 21:10:00,337 - INFO - Queried market_prices with 897172 records in 7.36 seconds
2025-05-09 21:10:00,337 - INFO - Querying table: sales_history
2025-05-09 21:10:19,242 - INFO - Queried sales_history with 1644689 records in 18.90 seconds
2025-05-09 21:10:19,242 - INFO - Querying table: listings
2025-05-09 21:11:09,117 - INFO - Queried listings with 2523088 records in 49.88 seconds
2025-05-09 21:11:09,187 - INFO - Market data fetch from TimescaleDB completed successfully
2025-05-09 21:11:09,362 - INFO - Starting data cleaning with card and market DataFrames
2025-05-09 21:11:09,501 - INFO - Processed market_prices with 897172 records
2025-05-09 21:11:09,619 - INFO - Original sales_history price stats: mean=623.28, median=607.89, std=124.81
2025-05-09 21:11:15,234 - INFO - Method zscore: Removed 1252 outliers from price in sales_history
2025-05-09 21:11:29,115 - INFO - Method iqr: Removed 88127 outliers from price in sales_history
2025-05-09 21:11:43,394 - INFO - Method percentile: Removed 36704 outliers from price in sales_history
2025-05-09 21:11:43,475 - INFO - zscore cleaned stats: mean=622.97, median=607.88, std=122.79
2025-05-09 21:11:43,555 - INFO - iqr cleaned stats: mean=613.52, median=605.66, std=93.18
2025-05-09 21:11:43,651 - INFO - percentile cleaned stats: mean=621.08, median=608.03, std=109.74
2025-05-09 21:15:36,456 - INFO - Aggregated sales_history to 544260 daily records with enhanced metrics
2025-05-09 21:15:36,846 - INFO - Processed listings with 2523088 records
2025-05-09 21:15:37,051 - INFO - Merged market_prices with 897172 records
2025-05-09 21:15:37,472 - INFO - Merged sales_history with 544260 records
2025-05-09 21:15:38,611 - INFO - Merged listings with 2523088 records
2025-05-09 21:15:39,383 - INFO - After filtering card_sku_id with no SQL table data, 2757625 rows remain
2025-05-09 21:15:39,397 - INFO - Set price and quantity to 0 for no seller inventory in listings
2025-05-09 21:15:39,397 - INFO - Data cleaning completed successfully
