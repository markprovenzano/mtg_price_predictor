2025-05-10 12:15:59,792 - INFO - Starting pipeline execution
2025-05-10 12:15:59,792 - INFO - Fetching market data
2025-05-10 12:15:59,823 - INFO - Loaded 22037 card_sku_id values from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-10 12:16:00,015 - INFO - Connected to TimescaleDB database: tsdb
2025-05-10 12:16:24,505 - INFO - Filtered to 16035 card_sku_id values with >= 12 sales over 60 days
2025-05-10 12:16:24,507 - INFO - Querying table: market_prices
2025-05-10 12:16:30,551 - INFO - Queried market_prices with 897956 records in 6.04 seconds
2025-05-10 12:16:30,551 - INFO - Querying table: sales_history
2025-05-10 12:16:49,378 - INFO - Queried sales_history with 1671935 records in 18.83 seconds
2025-05-10 12:16:49,383 - INFO - Querying table: listings
2025-05-10 12:17:34,574 - INFO - Queried listings with 6724910 records in 45.19 seconds
2025-05-10 12:17:34,757 - INFO - Market data fetch from TimescaleDB completed successfully
2025-05-10 12:17:35,163 - INFO - Fetched market data: 897956 market_prices, 1671935 sales_history, 6724910 listings
2025-05-10 12:17:35,163 - INFO - Loading card attributes
2025-05-10 12:17:35,316 - INFO - Loaded 284714 card_attributes records
2025-05-10 12:17:35,317 - INFO - Running merge_data
2025-05-10 12:17:35,317 - INFO - Starting merge_data execution
2025-05-10 12:17:35,317 - INFO - Received input sizes: market_prices=897956, sales_history=1671935, listings=6724910, card_attributes=284714
2025-05-10 12:17:35,498 - INFO - Filtered card_attributes to 16035 relevant records
2025-05-10 12:18:27,116 - INFO - Filtered 46466 outliers from price
2025-05-10 12:18:32,651 - INFO - Merged data size: 6624411
2025-05-10 12:18:49,976 - INFO - Outlier validation stats: {'25x': 340, '50x': 93, '100x': 38}
2025-05-10 12:18:50,802 - INFO - Saved diagnostics to C:\Users\mprov\PycharmProjects\mtg_price_predictor\logs\merge_data_diagnostic_20250510_121850.json
2025-05-10 12:18:50,819 - INFO - Merged data size: 6624411
2025-05-10 12:18:50,819 - INFO - Merge stats: {'record_counts': {'market_prices': 897956, 'sales_history': 1671935, 'sales_history_filtered': 1625469, 'listings': 6724910, 'card_attributes': 16035, 'merged': 6624411}, 'nan_counts': {'low': 0, 'market': 0, 'direct_low': 89766, 'price': 115920, 'quantity': 115920, 'direct_inventory_count': 115920, 'sales_quantity': 82438, 'sales_price_mean': 82438, 'sales_price_max': 82438}, 'low_inventory': {'count': 1705144, 'proportion': 0.2738352665862307}, 'outlier_stats': {'removed_count': 46466, 'removed_proportion': 0.027791750277373222, 'price_min': 32.2, 'price_max': 500.0, 'price_mean': 50.6034582275212, 'price_median': 42.92, 'validation': {'25x': 340, '50x': 93, '100x': 38}}, 'non_zero_sales': 4528030, 'correlation': np.float64(0.054019477210543086)}
2025-05-10 12:18:50,819 - INFO - Pipeline execution completed
