2025-05-10 14:52:47,171 - INFO - Starting pipeline execution
2025-05-10 14:52:47,171 - INFO - Fetching market data
2025-05-10 14:52:47,200 - INFO - Loaded 22037 card_sku_id values from C:\Users\mprov\PycharmProjects\mtg_price_predictor\data\raw\card_list.csv
2025-05-10 14:52:47,401 - INFO - Connected to TimescaleDB database: tsdb
2025-05-10 14:53:11,792 - INFO - Filtered to 16035 card_sku_id values with >= 12 sales over 60 days
2025-05-10 14:53:11,797 - INFO - Querying table: market_prices
2025-05-10 14:53:18,196 - INFO - Queried market_prices with 904566 records in 6.40 seconds
2025-05-10 14:53:18,196 - INFO - Querying table: sales_history
2025-05-10 14:53:37,032 - INFO - Queried sales_history with 1671935 records in 18.84 seconds
2025-05-10 14:53:37,036 - INFO - Querying table: listings
2025-05-10 14:54:39,902 - INFO - Queried listings with 6724910 records in 62.87 seconds
2025-05-10 14:54:40,112 - INFO - Market data fetch from TimescaleDB completed successfully
2025-05-10 14:54:40,624 - INFO - Fetched market data: 904566 market_prices, 1671935 sales_history, 6724910 listings
2025-05-10 14:54:40,624 - INFO - Loading card attributes
2025-05-10 14:54:40,777 - INFO - Loaded 284714 card_attributes records
2025-05-10 14:54:40,778 - INFO - Running merge_data
2025-05-10 14:54:40,778 - INFO - Starting merge_data execution
2025-05-10 14:54:40,778 - INFO - Received input sizes: market_prices=904566, sales_history=1671935, listings=6724910, card_attributes=284714
2025-05-10 14:54:40,784 - INFO - Raw NaN counts: {'direct_low_raw_nans': 358317, 'market_raw_nans': 0, 'low_raw_nans': 4557, 'lowest_list_raw_nans': 4557}
2025-05-10 14:54:40,979 - INFO - Filtered card_attributes to 16035 relevant records
2025-05-10 14:55:48,584 - ERROR - Error in merge_data: "None of [Index(['quantity', 'price'], dtype='object')] are in the [columns]"
2025-05-10 14:55:48,586 - INFO - Error logged to C:\Users\mprov\PycharmProjects\mtg_price_predictor\logs\error_log.json: merge_data
2025-05-10 14:55:48,586 - ERROR - Failed to merge data: "None of [Index(['quantity', 'price'], dtype='object')] are in the [columns]"
2025-05-10 14:55:48,586 - ERROR - Pipeline failed: "None of [Index(['quantity', 'price'], dtype='object')] are in the [columns]"
